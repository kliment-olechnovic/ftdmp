################################################################################

time -p ( \
./ftdmp-all                                                                    \
  --job-name                '6v3p_redock'                                      \
  --static-file             './test/reference_dimers/6V3P_AB.pdb'              \
  --static-sel              '[-chain A]'                                       \
  --mobile-file             './test/reference_dimers/6V3P_AB.pdb'              \
  --mobile-sel              '[-chain B]'                                       \
  --subselect-contacts      '[]'                                               \
  --reference               './test/reference_dimers/6V3P_AB.pdb'              \
  --openmm-forcefield       'amber99sb'                                        \
  --conda-path              "$HOME/anaconda3"                                  \
  --conda-env               'alphafold2'                                       \
  --ftdock-keep             '5'                                                \
  --ftdock-angle-step       '9'                                                \
  --min-grid-sep            '20'                                               \
  --parallel-docking        '16'                                               \
  --parallel-scoring        '16'                                               \
  --sbatch-docking          ''                                                 \
  --sbatch-scoring          ''                                                 \
  --scoring-full-top        '1000'                                             \
  --scoring-rank-names      'standard_for_protein_protein'                     \
  --scoring-ranks-top       '100'                                              \
  --scoring-jury-slices     '5  50'                                            \
  --redundancy-threshold    '1.0'                                              \
  --build-complexes         '500'                                              \
  --relax-complexes         "--max-iterations 0 --force-cuda --focus whole_interface" \
  --output-dir              './test/output/redocking_hetero'                   \
)

################################################################################

time -p ( \
./ftdmp-all                                                                        \
  --job-name                '1h0x_redock'                                      \
  --static-file             './test/reference_dimers/1H0X_AB.pdb'              \
  --static-sel              '[-chain A]'                                       \
  --static-chain            'A'                                                \
  --mobile-file             './test/reference_dimers/1H0X_AB.pdb'              \
  --mobile-sel              '[-chain A]'                                       \
  --mobile-chain            'B'                                                \
  --subselect-contacts      '[]'                                               \
  --reference               './test/reference_dimers/1H0X_AB.pdb'              \
  --openmm-forcefield       'amber99sb'                                        \
  --conda-path              "$HOME/anaconda3"                                  \
  --conda-env               'alphafold2'                                       \
  --ftdock-keep             '5'                                                \
  --ftdock-angle-step       '9'                                                \
  --min-grid-sep            '20'                                               \
  --parallel-docking        '16'                                               \
  --parallel-scoring        '16'                                               \
  --sbatch-docking          ''                                                 \
  --sbatch-scoring          ''                                                 \
  --score-symmetry          'true'                                             \
  --remap-cadscore          'true'                                             \
  --scoring-full-top        '1000'                                             \
  --scoring-rank-names      'standard_for_protein_protein'                     \
  --scoring-ranks-top       '100'                                              \
  --scoring-jury-slices     '5  50'                                            \
  --redundancy-threshold    '1.0'                                              \
  --build-complexes         '500'                                              \
  --relax-complexes         "--max-iterations 0 --force-cuda --focus whole_interface" \
  --output-dir              './test/output/redocking_homo'                     \
)

################################################################################

time -p ( \
./ftdmp-all                                                                        \
  --job-name                '1my7_redock'                                      \
  --static-file             './test/reference_dimers/1MY7_AB.pdb'              \
  --static-sel              '[-chain A]'                                       \
  --static-chain            'A'                                                \
  --mobile-file             './test/reference_dimers/1MY7_AB.pdb'              \
  --mobile-sel              '[-chain A]'                                       \
  --mobile-chain            'B'                                                \
  --subselect-contacts      '[]'                                               \
  --reference               './test/reference_dimers/1MY7_AB.pdb'              \
  --openmm-forcefield       'amber99sb'                                        \
  --conda-path              "$HOME/anaconda3"                                  \
  --conda-env               'alphafold2'                                       \
  --ftdock-keep             '5'                                                \
  --ftdock-angle-step       '9'                                                \
  --min-grid-sep            '20'                                               \
  --parallel-docking        '16'                                               \
  --parallel-scoring        '16'                                               \
  --sbatch-docking          ''                                                 \
  --sbatch-scoring          ''                                                 \
  --score-symmetry          'true'                                             \
  --remap-cadscore          'true'                                             \
  --scoring-full-top        '1000'                                             \
  --scoring-rank-names      'standard_for_protein_protein'                     \
  --scoring-ranks-top       '100'                                              \
  --scoring-jury-slices     '5  50'                                            \
  --redundancy-threshold    '1.0'                                              \
  --build-complexes         '10'                                               \
  --output-dir              './test/output/redocking_homo'                     \
)

################################################################################

time -p ( \
./ftdmp-all                                                                        \
  --job-name                '1b7f_redock'                                      \
  --static-file             './test/reference_dimers/1B7F_AP.pdb'              \
  --static-sel              '[-chain A]'                                       \
  --mobile-file             './test/reference_dimers/1B7F_AP.pdb'              \
  --mobile-sel              '[-chain P]'                                       \
  --subselect-contacts      '[]'                                               \
  --reference               './test/reference_dimers/1B7F_AP.pdb'              \
  --ftdock-keep             '5'                                                \
  --ftdock-angle-step       '9'                                                \
  --min-grid-sep            '20'                                               \
  --parallel-docking        '16'                                               \
  --parallel-scoring        '16'                                               \
  --scoring-full-top        '1000'                                             \
  --scoring-rank-names      'standard_for_generic'                             \
  --scoring-ranks-top       '100'                                              \
  --scoring-jury-slices     '5  50'                                            \
  --build-complexes         '10'                                               \
  --output-dir              './test/output/redocking_hetero'                   \
)

################################################################################

time -p ( \
./ftdmp-all                                                                        \
  --job-name                '2bna_redock'                                      \
  --static-file             './test/reference_dimers/2BNA_AB.pdb'              \
  --static-sel              '[-chain A]'                                       \
  --mobile-file             './test/reference_dimers/2BNA_AB.pdb'              \
  --mobile-sel              '[-chain B]'                                       \
  --subselect-contacts      '[]'                                               \
  --reference               './test/reference_dimers/2BNA_AB.pdb'              \
  --ftdock-keep             '5'                                                \
  --ftdock-angle-step       '9'                                                \
  --min-grid-sep            '20'                                               \
  --parallel-docking        '16'                                               \
  --parallel-scoring        '16'                                               \
  --scoring-full-top        '1000'                                             \
  --scoring-rank-names      'standard_for_generic'                             \
  --scoring-ranks-top       '100'                                              \
  --scoring-jury-slices     '5  50'                                            \
  --build-complexes         '10'                                               \
  --output-dir              './test/output/redocking_hetero'                   \
)

################################################################################

time -p ( \
./ftdmp-all                                                                        \
  --job-name                '1x9n_redock'                                      \
  --static-file             './test/reference_dimers/1X9N_A_BCD.pdb'           \
  --static-sel              '[-chain A]'                                       \
  --mobile-file             './test/reference_dimers/1X9N_A_BCD.pdb'           \
  --mobile-sel              '[-chain B,C,D]'                                   \
  --subselect-contacts      '[-a1 [-chain A] -a2 [-chain B,C,D]]'              \
  --reference               './test/reference_dimers/1X9N_A_BCD.pdb'           \
  --ftdock-keep             '5'                                                \
  --ftdock-angle-step       '9'                                                \
  --min-grid-sep            '20'                                               \
  --parallel-docking        '16'                                               \
  --parallel-scoring        '16'                                               \
  --scoring-full-top        '1000'                                             \
  --scoring-rank-names      'standard_for_generic'                             \
  --scoring-ranks-top       '100'                                              \
  --scoring-jury-slices     '5  50'                                            \
  --build-complexes         '10'                                               \
  --output-dir              './test/output/redocking_hetero'                   \
)

################################################################################

exit 0

################################################################################

time -p ( \
./ftdmp-all                                                                        \
  --job-name                'capri188_reverse'                                 \
  --mobile-file             './test/just_monomers/capri188_protein_AB.pdb'     \
  --mobile-sel              '[-chain A,B]'                                     \
  --static-file             './test/just_monomers/capri188_dna_EF.pdb'         \
  --static-sel              '[-chain E,F]'                                     \
  --subselect-contacts      '[-a1 [-chain A,B] -a2 [-chain E,F]]'              \
  --openmm-forcefield       'amber14-all-no-water'                             \
  --conda-path              "$HOME/anaconda3"                                  \
  --conda-env               'alphafold2'                                       \
  --ftdock-keep             '5'                                                \
  --ftdock-angle-step       '9'                                                \
  --min-grid-sep            '20'                                               \
  --parallel-docking        '8'                                                \
  --parallel-scoring        '16'                                                \
  --remap-cadscore          'true'                                             \
  --scoring-full-top        '1000'                                             \
  --scoring-rank-names      'standard_for_generic'                             \
  --scoring-ranks-top       '100'                                              \
  --scoring-jury-slices     '5  50'                                            \
  --redundancy-threshold    '0.05'                                             \
  --build-complexes         '500'                                              \
  --multiply-chains         "--static-align-sel '[-chain A]' --mobile-align-sel '[-chain B]' --multiply-sel '[-chain E,F]' --rename-chain 'E=C,F=D'" \
  --relax-complexes         " --max-iterations 0 --force-cuda --focus whole_interface --focus-base '[-protein]' --focus-first-sel '[-chain A,B]' --focus-second-sel '[-chain C,D,E,F]'" \
  --output-dir              './test/output/capri'                              \
)

cat "./test/output/capri/capri188_reverse/relaxed/relaxed_top_scoring_results_nonredundant.txt" \
| head -11 \
| ./ftdmp-form-capri-answer \
  --input-prefix './test/output/capri/capri188_reverse/relaxed/relaxed_top_complexes/' \
  --input-suffix '.pdb' \
  --brk './test/output/capri/answer_capri188/capri_53_188.brk' \
  --output './test/output/capri/capri188_reverse/relaxed/capri_answer.pdb' \
  --authors 'J.DAPKUNAS, K.OLECHNOVIC, C.VENCLOVAS' \
  --align-sel '[-chain A]' \
  --rename-chains 'E=R,F=S,C=T,D=U'

################################################################################

time -p ( \
./ftdmp-all                                                                        \
  --job-name                'capri188'                                         \
  --static-file             './test/just_monomers/capri188_protein_AB.pdb'     \
  --static-sel              '[-chain A,B]'                                     \
  --mobile-file             './test/just_monomers/capri188_dna_EF.pdb'         \
  --mobile-sel              '[-chain E,F]'                                     \
  --subselect-contacts      '[-a1 [-chain A,B] -a2 [-chain E,F]]'              \
  --openmm-forcefield       'amber14-all-no-water'                             \
  --conda-path              "$HOME/anaconda3"                                  \
  --conda-env               'alphafold2'                                       \
  --ftdock-keep             '5'                                                \
  --ftdock-angle-step       '9'                                                \
  --min-grid-sep            '20'                                               \
  --parallel-docking        '8'                                                \
  --parallel-scoring        '16'                                                \
  --remap-cadscore          'true'                                             \
  --scoring-full-top        '1000'                                             \
  --scoring-rank-names      'standard_for_generic'                             \
  --scoring-ranks-top       '100'                                              \
  --scoring-jury-slices     '5  50'                                            \
  --redundancy-threshold    '0.05'                                             \
  --build-complexes         '500'                                              \
  --multiply-chains         "--static-align-sel '[-chain A]' --mobile-align-sel '[-chain B]' --multiply-sel '[-chain E,F]' --rename-chain 'E=C,F=D'" \
  --relax-complexes         " --max-iterations 0 --force-cuda --focus whole_interface --focus-base '[-protein]' --focus-first-sel '[-chain A,B]' --focus-second-sel '[-chain C,D,E,F]'" \
  --output-dir              './test/output/capri'                              \
)

cat "./test/output/capri/capri188/relaxed/relaxed_top_scoring_results_nonredundant.txt" \
| head -11 \
| ./ftdmp-form-capri-answer \
  --input-prefix './test/output/capri/capri188/relaxed/relaxed_top_complexes/' \
  --input-suffix '.pdb' \
  --brk './test/output/capri/answer_capri188/capri_53_188.brk' \
  --output './test/output/capri/capri188/relaxed/capri_answer.pdb' \
  --authors 'J.DAPKUNAS, K.OLECHNOVIC, C.VENCLOVAS' \
  --force-top-picks 'capri188_71341' \
  --rename-chains 'E=R,F=S,C=T,D=U'

################################################################################

time -p ( \
./ftdmp-all                                                                        \
  --job-name                'capri188_more'                                         \
  --static-file             './test/just_monomers/capri188_protein_AB.pdb'     \
  --static-sel              '[-chain A,B]'                                     \
  --mobile-file             './test/just_monomers/capri188_dna_EF.pdb'         \
  --mobile-sel              '[-chain E,F]'                                     \
  --subselect-contacts      '[-a1 [-chain A,B] -a2 [-chain E,F]]'              \
  --openmm-forcefield       'amber14-all-no-water'                             \
  --conda-path              "$HOME/anaconda3"                                  \
  --conda-env               'alphafold2'                                       \
  --ftdock-keep             '10'                                                \
  --ftdock-angle-step       '9'                                                \
  --min-grid-sep            '10'                                               \
  --parallel-docking        '8'                                                \
  --parallel-scoring        '16'                                                \
  --remap-cadscore          'true'                                             \
  --scoring-full-top        '2000'                                             \
  --scoring-rank-names      'standard_for_generic'                             \
  --scoring-ranks-top       '200'                                              \
  --scoring-jury-slices     '5  50'                                            \
  --redundancy-threshold    '0.05'                                             \
  --build-complexes         '500'                                              \
  --multiply-chains         "--static-align-sel '[-chain A]' --mobile-align-sel '[-chain B]' --multiply-sel '[-chain E,F]' --rename-chain 'E=C,F=D'" \
  --relax-complexes         " --max-iterations 0 --force-cuda --focus whole_interface --focus-base '[-protein]' --focus-first-sel '[-chain A,B]' --focus-second-sel '[-chain C,D,E,F]'" \
  --output-dir              './test/output/capri'                              \
)

cat "./test/output/capri/capri188_more/relaxed/relaxed_top_scoring_results_nonredundant.txt" \
| head -11 \
| ./ftdmp-form-capri-answer \
  --input-prefix './test/output/capri/capri188_more/relaxed/relaxed_top_complexes/' \
  --input-suffix '.pdb' \
  --brk './test/output/capri/answer_capri188/capri_53_188.brk' \
  --output './test/output/capri/capri188_more/relaxed/capri_answer.pdb' \
  --authors 'J.DAPKUNAS, K.OLECHNOVIC, C.VENCLOVAS' \
  --rename-chains 'E=R,F=S,C=T,D=U'

################################################################################

time -p ( \
./ftdmp-all                                                                    \
  --job-name                '6v3p_models'                                      \
  --static-file             './test/reference_dimers/6V3P_AB.pdb'              \
  --static-sel              '[-chain A]'                                       \
  --mobile-file             './test/reference_dimers/6V3P_AB.pdb'              \
  --mobile-sel              '[-chain B]'                                       \
  --subselect-contacts      '[]'                                               \
  --reference               './test/reference_dimers/6V3P_AB.pdb'              \
  --openmm-forcefield       'amber99sb'                                        \
  --conda-path              "$HOME/anaconda3"                                  \
  --conda-env               'alphafold2'                                       \
  --ftdock-keep             '1'                                                \
  --ftdock-angle-step       '9'                                                \
  --min-grid-sep            '20'                                               \
  --parallel-docking        '16'                                               \
  --parallel-scoring        '16'                                               \
  --scoring-rank-names      'simple_for_protein_protein'                       \
  --scoring-full-top        '1000'                                             \
  --only-dock-and-score     'true'                                             \
  --output-dir              './test/output/diverse_redocking_hetero'           \
)

time -p ( \
./ftdmp-all-diversify \
    --input-scoring-table   './test/output/diverse_redocking_hetero/6v3p_models/raw_scoring_results.txt' \
    --names-prefix          'raw_' \
    --cadscore-step         '0.05' \
    --site-cadscore-step    '0.05' \
    --build-complexes       '500' \
)

################################################################################

